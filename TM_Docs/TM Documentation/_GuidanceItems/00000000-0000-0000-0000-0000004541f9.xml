<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="00000000-0000-0000-0000-0000004541f9" Author="" Category=" " Priority="" Rule_Type="" Status="" Technology="TeamMentor" title="Script - Batch Creation of Users from CSV file" Topic="" phase="Draft" libraryId="eb39d862-f752-4d1c-ab6e-14ed697397c0" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//var tmSite= &amp;quot;http://localhost.:12345&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//var adminPwd = &amp;quot;....!&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var tmSite = &amp;quot;http://teammentor.securityinnovation.com&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var adminPwd = &amp;quot;...&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var tmWebServices = new API_TeamMentor_WebServices(tmSite); &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;tmWebServices.login(&amp;quot;admin&amp;quot;,adminPwd).str();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var topPanel = panel.clear().add_Panel();&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var dataGridView = topPanel.add_DataGridView();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;dataGridView.add_Columns(&amp;quot;UserID&amp;quot;,&amp;quot;UserName&amp;quot;,&amp;quot;Password&amp;quot;,&amp;quot;email&amp;quot;,&amp;quot;FirstName&amp;quot;,&amp;quot;LastName&amp;quot;,&amp;quot;Role&amp;quot;,&amp;quot;Active&amp;quot;,&amp;quot;ExpirationDate&amp;quot;,&amp;quot;Title&amp;quot;, &amp;quot;Company&amp;quot;);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var csvFile1 = @&amp;quot;{path to}\V2 version - web users\UsersWithNoExpirationDate.csv&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var csvFile2 = @&amp;quot;&lt;/font&gt; &lt;span style="font-family:Arial,Verdana; font-size:small"&gt;
{path to}&lt;/span&gt;&lt;font face="Arial, Verdana" size="2"&gt;\V2 version - web users\UsersWithFutureExpirationDate.csv&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var csvContent = csvFile1.fileContents().line() &amp;#43;&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;nbsp; &amp;nbsp; csvFile2.fileContents().line();&lt;br&gt;
&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var lines = csvContent.split_onLines().removeEmpty();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//var line = lines[0];&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var max = 1000;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;foreach(var line in lines)&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;{&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var items = line.remove(&amp;quot;NULL&amp;quot;).split(&amp;quot;,&amp;quot;);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//tmWebServices.delete_User(items[1]);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var role = items[6].toInt() &amp;#43; 1;&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var note = &amp;quot;CSV Import&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;tmWebServices.add_User(items[1], items[2], items[3], items[4], items[5], role, items[9], items [10], &amp;nbsp;note);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;dataGridView.add_Row(items.ToArray());&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;if (max-- == 0)&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;break;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;}&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;return tmWebServices.users().size();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2File:API_TeamMentor_WebServices.cs&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//using SecurityInnovation.TeamMentor&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2Ref:System.Web.Services.dll&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2Ref:O2_Misc_Microsoft_MPL_Libs.dll&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//_O2Tag_DontAddExtraO2Files&lt;/font&gt;&lt;/div&gt;
</content>
</guidanceItem>