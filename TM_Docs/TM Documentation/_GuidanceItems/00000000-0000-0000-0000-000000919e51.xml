<?xml version="1.0" encoding="utf-8"?>
<guidanceItem id="00000000-0000-0000-0000-000000919e51" Author="" Category=" " Priority="" Rule_Type="Script" Status="" Technology="TeamMentor" title="Script - Creating TM Library based on CWE files" Topic="" phase="Draft" libraryId="eb39d862-f752-4d1c-ab6e-14ed697397c0" xmlns="urn:microsoft:guidanceexplorer:guidanceItem">
  <content>
&lt;div style="font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal"&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;div style="font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal"&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;h3&gt;File 1&lt;/h3&gt;
&lt;div style="font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal"&gt;
&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var xmlFile = @&amp;quot;C:\O2\_tempDir\2-23-2012\tmp26D7_cwec_v2.1.xml\cwec_v2.1.xml&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var xmlData = Weakness_Catalog.Load(xmlFile);&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var targetFile = @&amp;quot;C:\O2\_tempDir\2-28-2012\cweData.xml&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var cweData= new CWE_Data();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;var maxItems = 5000;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;foreach(var weakness in xmlData.Weaknesses.Weakness)&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;{&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var cweWeakness = new CWE_Weakness();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Content = weakness.Description.str();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;if (weakness.Applicable_Platforms.isNull() || weakness.Applicable_Platforms.Languages.isNull())&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Technology = &amp;quot;NA&amp;quot;;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;else&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;{&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//return weakness;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var languages = weakness.Applicable_Platforms.Languages;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;if (languages.Language_Class.size() &amp;gt;0)&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Technology = languages.Language_Class[0].Language_Class_Description;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;else&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Technology = languages.Language[0].Language_Name;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;}&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//cweWeakness.Phase = weakness.Causal_Nature;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//if (cweWeakness.Phase.inValid())&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//return weakness;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Title = &amp;quot;CWE:{0} - {1}&amp;quot;.format(weakness.ID, weakness.Name);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;nbsp;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Phase = (weakness.Time_of_Introduction.isNull())&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;? &amp;quot;&amp;quot;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;: weakness.Time_of_Introduction.Introductory_Phase.toList().join(&amp;quot;,&amp;quot;);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;//&amp;quot;phase: {0}&amp;quot;.info(cweWeakness.Phase);&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Type = weakness.Status;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweWeakness.Category = &amp;quot;CWE&amp;quot;;&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;cweData.Weaknesses.Add(cweWeakness);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;}&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;cweData.saveAs(targetFile);&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;return cweData.Weaknesses.size();&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2File:CWE_Data.cs&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2File:cwe_schema_v5.1.cs&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;//O2Ref:O2_Misc_Microsoft_MPL_Libs.dll&lt;/font&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;h2&gt;&lt;font face="Arial, Verdana" size="2"&gt;File 2&lt;/font&gt;&lt;/h2&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;&lt;br&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div&gt;&lt;font face="Arial, Verdana" size="2"&gt;
&lt;div&gt;var topPanel = panel.clear().add_Panel(); &amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;var tmSite= &amp;quot;http://localhost.:12348&amp;quot;;&lt;/div&gt;
&lt;div&gt;//tmSite = &amp;quot;http://localhost.:12347&amp;quot;;&lt;/div&gt;
&lt;div&gt;//tmSite = &amp;quot;http://localhost.:3186&amp;quot;; &amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;tmSite = &amp;quot;http://50.19.221.68:92&amp;quot;;&lt;/div&gt;
&lt;div&gt;var libraryName = &amp;quot;CWE Library&amp;quot;;&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;var tmWebServices = new API_TeamMentor_WebServices(tmSite); &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;tmWebServices.login(&amp;quot;admin&amp;quot;,&amp;quot;!!tmbeta&amp;quot;).str();&lt;/div&gt;
&lt;div&gt;&amp;nbsp; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;var library = tmWebServices.library(libraryName)&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;.delete()&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;.library(libraryName);&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;var targetFile = @&amp;quot;C:\O2\_tempDir\2-28-2012\cweData.xml&amp;quot;; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;var cweData = targetFile.load&amp;lt;CWE_Data&amp;gt;();&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;var folderName = &amp;quot;Weakness Folder&amp;quot;;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;var viewName = &amp;quot;Weakness&amp;quot;; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;var view = library.folder(folderName)&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;nbsp;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;
&lt;/span&gt;&amp;nbsp;.view(viewName); &amp;nbsp;&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;var max = 1000; &amp;nbsp;&lt;/div&gt;
&lt;div&gt;var itemsAddded = 0;&lt;/div&gt;
&lt;div&gt;var o2Timer = new O2Timer(&amp;quot;created {0} in &amp;quot;.format(max)).start();&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;foreach(var weakness in cweData.Weaknesses)&lt;/div&gt;
&lt;div&gt;{ &lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var title = weakness.Title; &amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var content = weakness.Content;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var technology = weakness.Technology;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var phase = weakness.Phase;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var type = weakness.Type; &amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;var category = weakness.Category; &amp;nbsp;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;view.add_Article(title, content, technology, phase, type, category);&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;if (itemsAddded&amp;#43;&amp;#43; % 10 == 0)&amp;nbsp;&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;quot;[{0}/{1}] - {2}&amp;quot;.info(itemsAddded, cweData.Weaknesses.size(), title);&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;if (itemsAddded &amp;gt; max)&lt;/div&gt;
&lt;div&gt;&lt;span class="x_Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;break;&lt;/div&gt;
&lt;div&gt;}&lt;/div&gt;
&lt;div&gt;&amp;nbsp;o2Timer.stop();&lt;/div&gt;
&lt;div&gt;return view.articles();&lt;/div&gt;
&lt;div&gt;&amp;nbsp;&lt;/div&gt;
&lt;div&gt;//O2File:CWE_Data.cs &amp;nbsp;&lt;/div&gt;
&lt;div&gt;//O2File:API_TeamMentor_WebServices.cs&lt;/div&gt;
&lt;div&gt;//using SecurityInnovation.TeamMentor&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;//O2Ref:System.Web.Services.dll&lt;/div&gt;
&lt;div&gt;//O2Ref:O2_Misc_Microsoft_MPL_Libs.dll&lt;/div&gt;
&lt;div&gt;&lt;br&gt;
&lt;/div&gt;
&lt;div&gt;//O2Tag_DontAddExtraO2Files&lt;/div&gt;
&lt;/font&gt;&lt;/div&gt;
&lt;div style="font-family:Arial,Verdana; font-size:10pt; font-style:normal; font-variant:normal; font-weight:normal; line-height:normal"&gt;
&lt;br&gt;
&lt;/div&gt;
</content>
</guidanceItem>