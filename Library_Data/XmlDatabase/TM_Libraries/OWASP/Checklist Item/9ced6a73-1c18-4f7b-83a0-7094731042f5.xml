<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="-1214725624" Content_Hash="-803125434">
  <Metadata>
    <Id>9ced6a73-1c18-4f7b-83a0-7094731042f5</Id>
    <Library_Id>4738d445-bc9b-456c-8b35-a35057596c16</Library_Id>
    <Title>MSADC Virtual Directory (RDS) Is Removed Or Secured</Title>
    <Category>Server Hardening</Category>
    <Phase>Deployment</Phase>
    <Technology> Any</Technology>
    <Type>Checklist Item</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan</Priority>
    <Status />
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[
<h1>Applies to</h1>
<ul>
<li>
<div>Web Application</div>
</li></ul>
<h1>What to Check For</h1>
<p>Check to ensure that the MSADC virtual directory (RDS) is removed or secured.</p>
<br>
<h1>How to Fix</h1>
<p>Remote Data Services (RDS) is a component that enables controlled Internet access to&nbsp;remote data resources through IIS. The RDS interface is provided by Msadcs.dll, which is located in the following directory: program files\common files\system\Msadc.</p>
<h3>Removing RDS</h3>
<p>If your applications do not use RDS, remove it.</p>
<p><strong>To remove RDS support</strong> </p>
<ol>
<li>Remove the /MSADC virtual directory mapping from IIS. </li><li>Remove the RDS files and subdirectories at the following location:
<p>\Program Files\Common Files\System\Msadc </p>
</li><li>Remove the following registry key:
<p>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch </p>
</li></ol>
<blockquote><strong>Note</strong>&nbsp;&nbsp;&nbsp;IISLockdown provides an option to remove the MSADC virtual directory. Note that IISLockdown only removes the virtual directory, not the files or registry key.</blockquote>
<h3>Securing RDS</h3>
<p>If your applications require RDS, secure it.</p>
<p><strong>To secure RDS</strong> </p>
<ol>
<li>Delete the samples at the following location:
<p>\Progam Files\Common Files\System\Msadc\Samples </p>
</li><li>Remove the following registry key:
<p><strong>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\VbBusObj.VbBusObjCls</strong>
</p>
</li><li>Disable Anonymous access for the MSADC virtual directory in IIS. </li><li>Create a <strong>HandlerRequired</strong> registry key in the following location:
<p><strong>HKLM\Software\Microsoft\DataFactory\HandlerInfo\</strong> </p>
</li><li>Create a new DWORD value, and set it to <strong>1</strong> (1 indicates safe mode, while 0 indicates unsafe mode.
</li></ol>
<blockquote><strong>Note</strong>&nbsp;&nbsp;&nbsp;You can use the registry script file Handsafe.reg to change the registry key. The script file is located in the msadc directory: \Program Files\Common Files\System\msadc</blockquote>
<h1>Additional Resources</h1>
<p>For more information about securing RDS, see the following: </p>
<ul>
<li>MS99-025 Microsoft Security Program: Unauthorized Access to IIS Servers through ODBC Data Access with RDS at
<a href="http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx">http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx</a>.
</li><li>MS98-004 Microsoft Security Program: Microsoft Security Bulletin: Unauthorized ODBC Data Access with RDS and IIS at
<a href="http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx">http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx</a>.
</li><li>Microsoft Knowledge Base article 184375, &quot;PRB: Security Implications of RDS 1.5, IIS 3.0 or 4.0, and ODBC.&quot;
</li></ul>
<hr>
<p>Adapted from Microsoft patterns &amp; practices guidance.</p>
]]></Data>
  </Content>
</TeamMentor_Article>