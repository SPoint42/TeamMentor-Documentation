<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1904913087" Content_Hash="1555322477">
  <Metadata>
    <Id>2f0e253a-77be-4c14-b163-b2bb5a33930d</Id>
    <Library_Id>4738d445-bc9b-456c-8b35-a35057596c16</Library_Id>
    <Title>Extensions Not Used by the Application Are Mapped to 404.dll</Title>
    <Category>Server Hardening</Category>
    <Phase>Deployment</Phase>
    <Technology> Any</Technology>
    <Type>Checklist Item</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author>J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan</Author>
    <Priority>2</Priority>
    <Status />
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[
<h1>Applies to</h1>
<ul>
<li>
<div>Web Application</div>
</li></ul>
<h1>What to Check For</h1>
<p>Check to ensure that the extensions that are&nbsp;not used by the application are mapped to 404.dll.</p>
<br>
<h1>How to Fix</h1>
<p>On Windows&nbsp;2000 and Windows Server 2003, the IIS file extensions of interest include: .asp, .asa, .cer, .cdx, .htr, .idc, .shtm, .shtml, .stm, and .printer.</p>
<p>If you do not use any one of these extensions, map the extension to the 404.dll, which is provided by IISLockdown. For example, if you do not want to serve ASP pages to clients, map .asp to the 404.dll.</p>
<p>The mappings altered by IISLockdown depend on the server template that you choose:
</p>
<ul>
<li><strong>Static Web Server</strong>. If you run IISLockdown and choose the Static Web server option, then all of the above extensions are mapped to the 404.dll.
</li><li><strong>Dynamic Web Server</strong>. If you choose the Dynamic Web server option, which is the preferred option when serving ASP.NET pages, then .htr, .idc, .shtm, .shtml, .stm, and .printer are mapped to the 404.dll, while .asp, .cer, .cdx, and .asa are
 not. In this case, you should manually map .cer, .cdx, and .asa to the 404.dll. If you are not serving .asp, then you can map that as well.
</li></ul>
<h3>Why Map to the 404.dll?</h3>
<p>By mapping file extensions to the 404.dll, you prevent files from being returned and downloaded over HTTP. If you request a file with an extension mapped to the 404.dll, a Web page with the message &quot;HTTP 404 - File not found&quot; is displayed. You are recommended
 to map unused extensions to the 404.dll rather than deleting the mapping. If you delete a mapping, and a file is mistakenly left on the server (or put there by mistake) it can be displayed in clear text when it is requested because IIS does not know how to
 process it.</p>
<p><strong>To map a file extension to the 404.dll</strong> </p>
<ol>
<li>Start IIS. </li><li>Right-click your server name in the left window, and then click <strong>Properties</strong>.
</li><li>Ensure that the <strong>WWWService</strong> is selected in the <strong>Master</strong>
<strong>Properties</strong> drop-down list, and then click the adjacent <strong>Edit</strong> button.
</li><li>Click the <strong>Home</strong> <strong>Directory</strong> tab. </li><li>Click <strong>Configuration</strong>. The tabbed page is shown below.
<p><img src="http://msdn2.microsoft.com/en-us/library/Aa302432.f16thcm04(en-us,MSDN.10).gif" style="border:1px solid #000">&nbsp;</p>
</li></ol>
<p><strong><em>Mapping application extensions</em></strong> </p>
<ol>
<li>Select one of the extensions from the list, and then click <strong>Edit</strong>.
</li><li>Click <strong>Browse</strong> and navigate to \WINNT\system32\inetsrv\404.dll.
<blockquote><strong>Note</strong>&nbsp;&nbsp;&nbsp;This step assumes that you have previously run IISlockd.exe, as the 404.dll is installed by the IISLockdown tool.</blockquote>
</li><li>Click <strong>Open</strong>, and then click <strong>OK</strong>. </li><li>Repeat steps 6, 7 and 8 for all of the remaining file extensions. </li></ol>
<hr>
<p>Adapted from Microsoft patterns &amp; practices guidance.</p>
]]></Data>
  </Content>
</TeamMentor_Article>