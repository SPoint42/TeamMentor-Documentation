<?xml version="1.0"?>
<TeamMentor_Article Metadata_Hash="1676204695" Content_Hash="642580630">
  <Metadata>
    <Id>5ce93f58-53f1-4cb6-acac-b15f71b79bc7</Id>
    <Library_Id>00000000-0000-0000-0000-000000000000</Library_Id>
    <Title>Access to the Credential Store is Limited</Title>
    <Category>Authentication</Category>
    <Phase>Implementation</Phase>
    <Technology>Java</Technology>
    <Type>Checklist Item</Type>
    <DirectLink />
    <Tag />
    <Security_Demand />
    <Author />
    <Priority>2</Priority>
    <Status />
  </Metadata>
  <Content Sanitized="true" DataType="Html">
    <Data><![CDATA[<h1>What to Check For</h1><p>Ensure that access to the credential store is limited to administrators with the correct privileges. </p><h1>Why</h1><p>Unauthorized access to the credential store can lead to users' credentials being overwritten; therefore, allowing the attacker to gain access to application resources without obtaining valid credentials prior to the attack.</p><h1>How to Check</h1><p>Follow these steps to ensure that the credential store is properly secured: </p><ol><li><p><strong>Identify all routines that access the store. </strong>Locate all routines within your application that access the credential store. Such routines include:</p><ul><li>Authenticating users </li><li>Creating users </li><li>Modifying users </li><li>Changing user passwords</li></ul></li><li><p><strong>Verify that credentials for accessing the store are secured. </strong>Ensure that your application's access credentials and connection strings are not hard-coded into your application's code base. </p><ul><li>If your application <strong>uses a database</strong> for its credential repository, follow the <a href="347C1DE9-9132-4B10-9523-64059EAA9F48">Connection Strings are Secured</a> checklist to ensure that access credentials and connection strings are secured properly. </li><li>If your application <strong>does not use a database</strong> for its credential repository, consult the <a href="FA468EF2-F27F-40B8-BD43-302F66AA9C26">Plaintext Sensitive Data is Not Stored</a> checklist. Verify that only the appropriate components of your application are able to access the credential store.<br><br>Example of how <strong>not</strong> to handle access to the credential store: </li></ul><br><blockquote><blockquote><pre>// The application discloses the credentials necessary for accessing the user database<br>DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());<br>Connection cn = DriverManager.getConnection("jdbc:oracle:thin:@testbox:1521:orcl2", "myapp", "pass"); </pre></blockquote></blockquote></li><li><p><strong>Check the access controls for your credential store.</strong> Ensure that your application's credential store has the appropriate security in place. For instance, if your application uses a database for its credential store, verify that the database server is secured properly.</p></li></ol><ol></ol><h1>Problem Example</h1><p>The following code authenticates a user based on their credentials. Because the code discloses the credentials to the user database, anybody with access to the code also has&nbsp;access to the credential store. </p><blockquote><pre>public boolean validateUser(String user, char[] pass)<br> {<br>      boolean valid;<br>      Connection cn;<br>       // Prepare credentials before querying the credential store<br>      ...<br>       try<br>      {<br>            // The application discloses the credentials necessary for<br>            // accessing the user database<br>            DriverManager.registerDriver(new oracle.jdbc.driver.OracleDriver());<br>            cn = DriverManager.getConnection("jdbc:oracle:thin:@testbox:1521:orcl2",<br>                                              "myapp", "pass");<br>            // Query the credential store and perform the rest<br>            // of the authentication steps<br>            ...<br>      }<br>      catch (SQLException se)<br>      {<br>            // Add the appropriate logging and exception handling mechanisms<br>            return false;<br>      }<br>       return valid;<br>}</pre></blockquote><h1>Related Guideline</h1><ul><li><a href="AEE6B133-B34C-442F-9051-0D8DC51F072E">Guideline: Limit Access to the Credential Store (Java Web Application)</a> </li></ul>]]></Data>
  </Content>
</TeamMentor_Article>